<main class="shell">
  <header class="hero">
    <h1>{{ title }}</h1>
    <p>Drag the pieces into place to complete the festive puzzle.</p>
  </header>

  <section class="board">
    <div class="game-wrapper">
      <div #gameHost class="game-host" aria-label="Puzzle board"></div>

      <button
        type="button"
        class="menu-toggle"
        (click)="toggleMenu()"
        aria-label="Toggle puzzle menu"
      >
        <span></span>
        <span></span>
        <span></span>
      </button>

      <nav *ngIf="menuOpen" class="mobile-menu" aria-label="Puzzle options">
        <button type="button" (click)="toggleDebug()">
          {{ showDebug ? 'Hide Guides' : 'Show Guides' }}
        </button>
        <button type="button" (click)="toggleGlassMode()">
          {{ useGlassStyle ? 'Opaque Pieces' : 'Glass Pieces' }}
        </button>
        <button type="button" (click)="closeMenu()">Close Menu</button>
      </nav>

      <div class="intro-overlay" *ngIf="showIntroOverlay">
        <div class="intro-card">
          <h1>{{ title }}</h1>
          <p>Drag the pieces into place to complete the festive puzzle.</p>
          <button type="button" (click)="startPuzzle()">Start Puzzle</button>
        </div>
      </div>

      <div class="complete-overlay" *ngIf="puzzleComplete">
        <div class="complete-card">
          <div *ngIf="coinTotal > 0">
            <h2>Du hast {{ coinTotal | number: '1.0-0' }} Münzen gesammelt! 💰</h2>
            <p>Möchtest du sie an OH22 schicken?<br>
            Wir wandeln deinen höchsten eingereichten Betrag in Euro um und spenden ihn an einen guten Zweck. ❤️</p>
            <p>Oder willst du dein Glück noch einmal versuchen und noch mehr Münzen sammeln? 🧩✨</p>
            <div class="complete-actions">
              <button type="button" *ngIf="!hideRestartButton" (click)="restartPuzzle()">Neues Spiel</button>
              <button type="button" (click)="donateCoins()">Münzen senden</button>
            </div>
          </div>
          <div *ngIf="coinTotal === 0">
            <h2>😅 Noch keine Münzen gesammelt!</h2>
            <p>Diesmal hast du 0 Münzen erreicht – aber kein Grund zur Sorge! 💪</p>
            <p>Vielleicht klappt’s beim nächsten Versuch besser.<br>
            Sammle Münzen, schick sie an OH22, und wir wandeln deinen höchsten Betrag in Euro um –<br>
            für einen guten Zweck! ❤️</p>
            <p>Bereit für eine neue Runde? 🧩✨</p>
            <div class="complete-actions">
              <button type="button" *ngIf="!hideRestartButton" (click)="restartPuzzle()">Neues Spiel</button>
            </div>
          </div>
          <div class="complete-donation" *ngIf="donationMessageVisible">
            {{ coinTotal | number: '1.0-0' }} Münzen für einen guten Zweck gespendet
          </div>
        </div>
      </div>

      <div class="stag-modal" *ngIf="showInitialContinueButton && !puzzleComplete">
        <div class="modal-content">
          <h1>... irgend etwas stimmt mit unserem Hirsch nicht!</h1>
          <button type="button" (click)="continueToPuzzle()">Weiter</button>
        </div>
      </div>

      <div class="explosion-modal" *ngIf="showExplosionModal && !puzzleComplete">
        <div class="modal-content">
          <h1>Oh nein – unser oh22 Weihnachtshirsch ist zerfallen!</h1>
          <p>Hilf uns dabei, die 22 verstreuten Teile wieder zusammenzusetzen, damit unser Hirsch alle Weihnachtsgeschenke rechtzeitig verteilen kann.</p>
          <button type="button" (click)="closeExplosionModal()">Los geht's</button>
        </div>
      </div>
    </div>

        <p class="instruction-text" [class.visible]="showInstructions">Ziehe die Teile mit der Maus an die richtige Stelle.</p>

    <div class="desktop-controls">
      <button type="button" (click)="toggleDebug()">
        {{ showDebug ? 'Hide' : 'Show' }} Guides
      </button>
      <button type="button" (click)="toggleGlassMode()">
        {{ useGlassStyle ? 'Opaque Pieces' : 'Glass Pieces' }}
      </button>
    </div>
  </section>
</main>
